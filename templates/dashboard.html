<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - RXZBot</title>
    <style>
        :root{
            --bg:#0a0e1a; --card:#0f1724; --muted:#9aa4b2; --accent:#00d4ff; --danger:#ff4757; --glass: rgba(255,255,255,0.02); --success:#2ed573;
            --radius:16px; --glow:0 0 20px rgba(0,212,255,0.3); --gold:#ffd700;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', system-ui, Arial;
            background: linear-gradient(135deg,#071026,#0d1526,#1a1f35);
            color: #eaf1ff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Particles */
        .particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0}
        .particle{position:absolute;background:var(--accent);border-radius:50%;opacity:0.1;animation:float 10s infinite linear}
        @keyframes float{from{transform:translateY(100vh) rotate(0deg)}to{transform:translateY(-100px) rotate(360deg)}}
        
        .header {
            background: linear-gradient(135deg,var(--card),rgba(15,23,36,0.9));
            color: white;
            padding: 25px 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            border-bottom: 1px solid rgba(0,212,255,0.2);
            position: relative;
            z-index: 10;
        }
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .welcome {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(90deg,var(--accent),#7b4bff);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }
        .logout-btn {
            background: linear-gradient(90deg,var(--danger),#ee5a6f);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .logout-btn::before{
            content:'';
            position:absolute;
            top:50%;
            left:50%;
            width:0;
            height:0;
            border-radius:50%;
            background:rgba(255,255,255,0.2);
            transition:width 0.6s,height 0.6s,top 0.6s,left 0.6s;
            pointer-events:none;
        }
        .logout-btn:hover::before{
            width:300px;
            height:300px;
            top:-150px;
            left:-150px;
        }
        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255,71,87,0.4);
        }
        .container {
            max-width: 1400px;
            margin: 30px auto;
            display: flex;
            gap: 25px;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }
        .sidebar {
            width: 280px;
            background: linear-gradient(135deg,var(--card),rgba(15,23,36,0.8));
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.05);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        .sidebar-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 12px;
        }
        .account-item {
            padding: 15px;
            margin-bottom: 12px;
            background: linear-gradient(135deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02));
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            color: var(--muted);
            display: block;
            border: 2px solid rgba(255,255,255,0.05);
            font-weight: 600;
        }
        .account-item:hover {
            background: linear-gradient(135deg,rgba(0,212,255,0.1),rgba(123,75,255,0.05));
            border-color: var(--accent);
            color: #fff;
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(0,212,255,0.2);
        }
        .account-item.active {
            background: linear-gradient(135deg,rgba(0,212,255,0.15),rgba(123,75,255,0.1));
            border-color: var(--accent);
            color: #fff;
            box-shadow: 0 0 25px rgba(0,212,255,0.3);
        }
        .add-account-btn {
            padding: 15px;
            background: linear-gradient(90deg,var(--success),#40c057);
            color: white;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: block;
            font-weight: 700;
            margin-top: 15px;
            position: relative;
            overflow: hidden;
        }
        .add-account-btn::before{
            content:'';
            position:absolute;
            top:50%;
            left:50%;
            width:0;
            height:0;
            border-radius:50%;
            background:rgba(255,255,255,0.2);
            transition:width 0.6s,height 0.6s,top 0.6s,left 0.6s;
            pointer-events:none;
        }
        .add-account-btn:hover::before{
            width:400px;
            height:400px;
            top:-200px;
            left:-200px;
        }
        .add-account-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(46,213,115,0.4);
        }
        .main-content {
            flex: 1;
            background: linear-gradient(135deg,var(--card),rgba(15,23,36,0.8));
            border-radius: var(--radius);
            padding: 35px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.05);
        }
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--muted);
        }
        .empty-state h2 {
            font-size: 2rem;
            margin-bottom: 15px;
            background: linear-gradient(90deg,var(--accent),#7b4bff);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }
        .empty-state p {
            font-size: 1.1rem;
            opacity: 0.8;
        }
        .tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 35px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            flex-wrap: wrap;
        }
        .tab {
            padding: 15px 28px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
            color: var(--muted);
            font-size: 1rem;
        }
        .tab:hover {
            color: var(--accent);
            background: rgba(0,212,255,0.05);
        }
        .tab.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
            background: linear-gradient(135deg,rgba(0,212,255,0.1),rgba(123,75,255,0.05));
        }
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .tab-content.active {
            display: block;
        }
        .account-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg,rgba(0,212,255,0.05),rgba(123,75,255,0.02));
            border-radius: 12px;
            border: 1px solid rgba(0,212,255,0.2);
        }
        .account-username {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(90deg,var(--accent),#7b4bff);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            margin-bottom: 12px;
        }
        .account-level {
            font-size: 2rem;
            font-weight: 600;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(255,215,0,0.3);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .stat-card {
            background: linear-gradient(135deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02));
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 10px 30px rgba(0,212,255,0.2);
        }
        .stat-label {
            color: var(--muted);
            font-size: 0.95rem;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(90deg,var(--accent),#7b4bff);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }
        .xp-section {
            margin-top: 35px;
        }
        .xp-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--accent);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 12px;
        }
        .license-info {
            background: linear-gradient(135deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02));
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .license-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .license-status h3 {
            font-size: 1.5rem;
            color: var(--accent);
            margin-bottom: 12px;
        }
        .license-status p {
            color: var(--muted);
            font-size: 1.05rem;
            margin-top: 8px;
        }
        .license-status strong {
            color: #fff;
        }
        .license-badge {
            padding: 12px 28px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .license-badge.active {
            background: linear-gradient(90deg,var(--success),#40c057);
            color: white;
            box-shadow: 0 5px 20px rgba(46,213,115,0.3);
        }
        .license-badge.paused {
            background: linear-gradient(90deg,#ffa500,#ff8c00);
            color: white;
            box-shadow: 0 5px 20px rgba(255,165,0,0.3);
        }
        .license-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }
        .btn::before{
            content:'';
            position:absolute;
            top:50%;
            left:50%;
            width:0;
            height:0;
            border-radius:50%;
            background:rgba(255,255,255,0.2);
            transition:width 0.6s,height 0.6s,top 0.6s,left 0.6s;
            pointer-events:none;
        }
        .btn:hover::before{
            width:400px;
            height:400px;
            top:-200px;
            left:-200px;
        }
        .btn-pause {
            background: linear-gradient(90deg,#ffa500,#ff8c00);
            color: white;
        }
        .btn-resume {
            background: linear-gradient(90deg,var(--success),#40c057);
            color: white;
        }
        .btn-extend {
            background: linear-gradient(90deg,var(--accent),#7b4bff);
            color: white;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,212,255,0.4);
        }
        .support-links {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .support-link {
            padding: 20px;
            background: linear-gradient(135deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02));
            border-radius: 12px;
            text-decoration: none;
            color: var(--muted);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.1);
            font-weight: 600;
            font-size: 1.05rem;
        }
        .support-link:hover {
            background: linear-gradient(135deg,rgba(0,212,255,0.1),rgba(123,75,255,0.05));
            border-color: var(--accent);
            color: #fff;
            transform: translateX(8px);
            box-shadow: 0 5px 25px rgba(0,212,255,0.2);
        }
        .support-link span:first-child {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        /* Responsive */
        @media(max-width:968px){
            .container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                position: static;
            }
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
            .account-username {
                font-size: 2rem;
            }
            .tabs {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <div class="header">
        <div class="header-content">
            <div class="welcome">‚ö° {{ email }}</div>
            <a href="/logout" class="logout-btn">Logout</a>
        </div>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="sidebar-title">üéÆ Your Accounts</div>
            {% for account in accounts %}
            <a href="/dashboard?account={{ account }}" class="account-item {% if account == selected_account %}active{% endif %}">
                {{ account }}
            </a>
            {% endfor %}
            <a href="/add_account" class="add-account-btn">+ Add Account</a>
        </div>

        <div class="main-content">
            {% if not selected_account %}
            <div class="empty-state">
                <h2>üöÄ Welcome to RXZBot Dashboard</h2>
                <p>Please choose an account from the sidebar or add a new one to get started</p>
            </div>
            {% else %}
            <div class="tabs">
                <div class="tab active" onclick="switchTab('main')">üìä Main Menu</div>
                <div class="tab" onclick="switchTab('xp')">‚ö° XP Tracking</div>
                <div class="tab" onclick="switchTab('license')">üé´ License</div>
                <div class="tab" onclick="switchTab('support')">üí¨ Support</div>
            </div>

            <div id="main-tab" class="tab-content active">
                <div class="account-header">
                    <div class="account-username">{{ account_data.username if account_data else selected_account }}</div>
                    <div class="account-level">‚≠ê Level {{ account_data.level if account_data else 'N/A' }}</div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">üÜî Player ID</div>
                        <div class="stat-value" style="font-size: 1rem;">{{ account_data.id if account_data else 'N/A' }}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">üíé Total XP</div>
                        <div class="stat-value">{{ account_data.xpTotal|default('N/A') if account_data else 'N/A' }}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">üìà XP Until Next Level</div>
                        <div class="stat-value">{{ account_data.xpUntilNextLevel|default('N/A') if account_data else 'N/A' }}</div>
                    </div>
                </div>
            </div>

            <div id="xp-tab" class="tab-content">
                <div class="account-header">
                    <div class="account-username">{{ selected_account }}</div>
                    <div class="account-level">‚≠ê Level {{ account_data.level if account_data else 'N/A' }}</div>
                </div>
                
                <div class="xp-section">
                    <div class="xp-title">ü§ñ Bot XP Statistics</div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">üìÖ XP Gained Today</div>
                            <div class="stat-value">
                                {% if account_xp and account_xp.daily %}
                                    {{ account_xp.daily.get(current_date, 0) }}
                                {% else %}
                                    0
                                {% endif %}
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">üìä XP Gained This Week</div>
                            <div class="stat-value">
                                {% if account_xp and account_xp.weekly %}
                                    {{ account_xp.weekly.get(current_week, 0) }}
                                {% else %}
                                    0
                                {% endif %}
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">üìà XP Gained This Month</div>
                            <div class="stat-value">
                                {% if account_xp and account_xp.monthly %}
                                    {{ account_xp.monthly.get(current_month, 0) }}
                                {% else %}
                                    0
                                {% endif %}
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">üèÜ Total Bot XP</div>
                            <div class="stat-value">{{ total_bot_xp if total_bot_xp else 0 }}</div>
                        </div>
                        <div class="stat-card" style="grid-column: span 2;">
                            <div class="stat-label">‚≠ê Levels Gained by Bot</div>
                            <div class="stat-value" style="font-size: 3rem;">{{ levels_gained if levels_gained else 0 }}</div>
                            <div style="color: var(--muted); font-size: 0.9rem; margin-top: 10px;">
                                ({{ total_bot_xp if total_bot_xp else 0 }} XP √∑ 2000 per level)
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="license-tab" class="tab-content">
                <div class="license-info">
                    <div class="license-status">
                        <div>
                            <h3>üé´ License Status</h3>
                            {% if license_data %}
                                {% if license_data.get('paused', False) %}
                                    <p style="margin-top: 10px;">Status: <strong style="color: #ffa500;">‚è∏Ô∏è Paused</strong></p>
                                    <p style="margin-top: 5px;">Paused on: <strong>{{ license_data.paused_at }}</strong></p>
                                    <p style="margin-top: 5px;">Days remaining: <strong>{{ license_data.remaining_days }}</strong></p>
                                {% else %}
                                    <p style="margin-top: 10px;">Expires: <strong>{{ license_data.expires }}</strong></p>
                                {% endif %}
                            {% else %}
                            <p style="margin-top: 10px; color: var(--danger);">‚ùå No active license</p>
                            {% endif %}
                        </div>
                        {% if license_data %}
                            {% if license_data.get('paused', False) %}
                            <div class="license-badge paused">
                                ‚è∏Ô∏è Paused
                            </div>
                            {% else %}
                            <div class="license-badge active">
                                ‚úì Active
                            </div>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
                
                {% if license_data %}
                <div class="license-actions">
                    {% if license_data.get('paused', False) %}
                    <button class="btn btn-resume" onclick="resumeLicense()">‚ñ∂Ô∏è Resume License</button>
                    {% else %}
                    <button class="btn btn-pause" onclick="pauseLicense()">‚è∏Ô∏è Pause License</button>
                    {% endif %}
                    <button class="btn btn-extend" onclick="extendLicense()">‚ûï Extend License</button>
                </div>
                {% endif %}
            </div>

            <div id="support-tab" class="tab-content">
                <h2 style="margin-bottom: 30px; font-size: 2rem; color: var(--accent);">üí¨ Support & Resources</h2>
                <div class="support-links">
                    <a href="https://rxzbot.com" target="_blank" class="support-link">
                        <span>üåê Official Website</span>
                        <span>‚Üí</span>
                    </a>
                    <a href="https://discord.gg/SHdrgSD2RJ" target="_blank" class="support-link">
                        <span>üí¨ Discord Server</span>
                        <span>‚Üí</span>
                    </a>
                    <a href="https://discord.com/users/rxzwashere" target="_blank" class="support-link">
                        <span>üìß Direct Support DM</span>
                        <span>‚Üí</span>
                    </a>
                    <a href="https://instagram.com/smsk_tarik" target="_blank" class="support-link">
                        <span>üì± Instagram</span>
                        <span>‚Üí</span>
                    </a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <script>
        // Particles animation (matching index.html)
        function createParticles(){
            const container = document.getElementById('particles');
            for(let i=0;i<50;i++){
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = Math.random()*100 + '%';
                p.style.width = p.style.height = Math.random()*4 + 2 + 'px';
                p.style.animationDelay = Math.random()*10 + 's';
                container.appendChild(p);
            }
        }
        createParticles();
        
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
        
        async function pauseLicense() {
            if (!confirm('‚è∏Ô∏è Are you sure you want to pause your license? You can resume it anytime.')) {
                return;
            }
            
            try {
                const response = await fetch('/api/license/pause', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: '{{ selected_account }}'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('‚úÖ License paused successfully!');
                    location.reload();
                } else {
                    alert('‚ùå Error: ' + data.error);
                }
            } catch (error) {
                alert('‚ùå An error occurred. Please try again.');
            }
        }
        
        async function resumeLicense() {
            if (!confirm('‚ñ∂Ô∏è Resume your license?')) {
                return;
            }
            
            try {
                const response = await fetch('/api/license/resume', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: '{{ selected_account }}'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('‚úÖ License resumed! New expiry: ' + data.new_expiry);
                    location.reload();
                } else {
                    alert('‚ùå Error: ' + data.error);
                }
            } catch (error) {
                alert('‚ùå An error occurred. Please try again.');
            }
        }
        
        async function extendLicense() {
            try {
                const response = await fetch('/api/license/extend', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: '{{ selected_account }}'
                    })
                });
                
                const data = await response.json();
                
                if (data.success && data.redirect) {
                    window.location.href = data.redirect;
                } else {
                    alert('‚ùå Error: ' + data.error);
                }
            } catch (error) {
                alert('‚ùå An error occurred. Please try again.');
            }
        }
    </script>
</body>
</html>